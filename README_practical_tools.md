# 实用工具类节点详细说明

实用工具类节点提供了一些辅助功能，包括值切换、随机执行、批量复制文件等实用工具。

## 功能概述

实用工具类节点是一组辅助性节点，旨在提高ComfyUI工作流的灵活性和便利性。这些节点提供了诸如值切换、随机执行、批量复制文件等功能，帮助用户更好地管理和控制他们的工作流。

## 节点列表

### 🔀 切换任意值节点 (ToggleAnyNode)

- **位置**: XnanTool/实用工具
- **功能**: 可以在两个任意类型的值之间切换的节点
- **输入**:
  - `input_value`: 布尔值输入，决定选择哪个值
  - `value_a`: 第一个可选值（任意类型）
  - `value_b`: 第二个可选值（任意类型）
- **控件**: 无
- **输出**:
  - `any_output`: 保持原始数据类型的输出
- **适用场景**: 
  - 在两个不同的值之间动态切换
  - 根据条件选择不同的参数值
  - 控制流程中需要根据不同条件使用不同数据的情况

### 🔁 切换值节点 (ToggleValueNode)

- **位置**: XnanTool/实用工具
- **功能**: 可以在两个值之间切换的节点，支持多种数据类型输入（FLOAT, INT, STRING）
- **输入**:
  - `input_value`: 布尔值输入，决定选择哪个值
  - `value_a`: 第一个可选值（任意类型）
  - `value_b`: 第二个可选值（任意类型）
- **控件**: 无
- **输出**:
  - `原始类型输出`: 保持原始数据类型的输出
  - `字符串输出`: 转换为字符串类型的输出
  - `整数输出`: 转换为整数类型的输出
  - `浮点输出`: 转换为浮点类型的输出
- **适用场景**: 
  - 在两个不同的值之间动态切换，并需要多种数据类型输出
  - 根据条件选择不同的参数值，并进行多种类型转换
  - 控制流程中需要根据不同条件使用不同数据，并提供多种输出格式

### 🎲 随机执行节点 (RandomExecutionNode)
- **位置**: `XnanTool/实用工具`
- **功能**: 支持随机、固定、顺序等多种执行模式的节点，根据实际连接的端口数量执行相应数量的操作，支持多种数据类型输入
- **输入**:
  - 执行模式(mode)：选择执行模式（random随机、fixed固定、sequential顺序循环）
  - 随机种子(seed)：用于随机模式的种子值
  - 位置编号(position)：用于fixed模式的位置编号（从1开始，循环执行）
  - 输入1-5(input_1~input_5)：可选的输入值
- **输出**:
  - 原始类型输出：根据选中输入值的原始类型输出
  - 字符串输出：将选中值转换为字符串
  - 整数输出：将选中值转换为整数
  - 浮点输出：将选中值转换为浮点数
  - 选中索引：被选中输入的索引编号
- **适用场景**: 
  - 在工作流中随机选择一个输入值进行处理
  - 按固定顺序循环执行不同的输入值
  - 根据位置参数循环选择特定的输入值

### 📁 批量复制文件节点 (BatchCopyFilesNode)
- **位置**: `XnanTool/实用工具`
- **功能**: 支持将指定目录中的文件批量复制到目标目录，支持文件过滤、覆盖选项和目录结构保留
- **输入**:
  - 源目录路径(source_directory)：要复制文件的源目录路径
  - 目标目录路径(destination_directory)：文件复制到的目标目录路径
  - 文件扩展名过滤(file_extensions)：要复制的文件扩展名，用逗号分隔（如：.jpg,.png,.txt），*表示所有文件
  - 覆盖已有文件(overwrite_existing)：是否覆盖目标目录中已存在的同名文件（true/false）
  - 保留目录结构(preserve_structure)：是否保留源目录的子目录结构（true/false）
- **输出**:
  - 处理结果信息：包含成功复制数量、跳过数量和错误信息的结构化结果信息
- **适用场景**: 
  - 批量备份图片或其他文件
  - 整理和迁移工作流中的资源文件
  - 复制特定类型的文件到指定目录

### 🔗 字符串合并节点 (StringMergeNode)
- **位置**: `XnanTool/实用工具`
- **功能**: 将多个字符串合并为一个字符串，支持自定义分隔符
- **输入**:
  - 字符串1(string1)：第一个要合并的字符串
  - 字符串2(string2)：第二个要合并的字符串
  - 字符串3(string3)：第三个要合并的字符串
  - 字符串4(string4)：第四个要合并的字符串
  - 字符串5(string5)：第五个要合并的字符串
  - 分隔符(separator)：用于分隔各个字符串的字符或字符串（默认为空）
- **输出**:
  - 合并后的字符串(merged_string)：将所有输入字符串按指定分隔符合并后的结果
- **适用场景**: 
  - 合并多个文本片段生成完整文本
  - 构造文件路径或URL
  - 组合提示词或其他文本信息

### ✍️ 文本输入节点 (TextInputNode)
- **位置**: `XnanTool/实用工具`
- **功能**: 允许用户输入多行文本的节点
- **输入**: 无
- **控件**:
  - 文本内容(text_content)：支持多行文本输入的文本框
- **输出**:
  - 输出文本(STRING)：用户输入的文本内容
- **适用场景**: 
  - 在工作流中直接输入文本内容
  - 编写提示词或其他需要手动输入的文本
  - 创建包含多行文本的工作流配置

### 🔄 字符串到任意类型节点 (StringToAnyNode)
- **位置**: `XnanTool/实用工具`
- **功能**: 将字符串转换为任意类型的节点
- **输入**:
  - 输入字符串(input_string)：要转换的字符串内容
- **控件**:
  - 输入字符串(input_string)：要转换的字符串内容
- **输出**:
  - 任意类型输出(any_output)：转换后的任意类型数据
- **适用场景**: 
  - 在工作流中将字符串数据传递给需要任意类型输入的节点
  - 作为数据类型转换的中间节点
  - 连接不同类型节点的桥梁

### 🔄 切换任意值（输出）节点 (ToggleAnyOutputNode)
- **位置**: `XnanTool/实用工具`
- **功能**: 根据布尔值将单个输入值路由到两个输出端口中的一个，实现单输入双输出的切换功能
- **输入**:
  - `toggle`: 布尔值输入，决定输出到哪个端口
  - `input_value`: 输入值（任意类型，可选）
- **输出**:
  - `output_a`: 当toggle为False时输出input_value，否则输出为空
  - `output_b`: 当toggle为True时输出input_value，否则输出为空
- **适用场景**: 
  - 将单个值路由到两个不同的处理路径
  - 根据条件将数据发送到不同的节点
  - 控制流程中需要根据不同条件选择输出路径的场景
  - 需要根据布尔值决定数据流向的场景

### 🔄 切换字符串（输出）节点 (ToggleStringOutputNode)
- **位置**: `XnanTool/实用工具`
- **功能**: 根据布尔值将字符串输入路由到两个输出端口中的一个，实现字符串单输入双输出的切换功能
- **输入**:
  - `toggle`: 布尔值输入，决定输出到哪个端口
  - `input_string`: 输入字符串
- **输出**:
  - `output_a`: 当toggle为False时输出input_string，否则输出为空
  - `output_b`: 当toggle为True时输出input_string，否则输出为空
- **适用场景**: 
  - 将单个字符串路由到两个不同的处理路径
  - 根据条件将字符串发送到不同的节点
  - 控制流程中需要根据不同条件选择字符串输出路径的场景
  - 需要根据布尔值决定字符串流向的场景

### 📝 MD转Excel节点 (MarkdownToExcelNode)
- **位置**: `XnanTool/实用工具`
- **功能**: 将Markdown文件转换为Excel文件，支持表格解析和自定义工作表名称
- **输入**:
  - `md_file_path`: Markdown文件路径
  - `output_excel_path`: 输出Excel文件路径
  - `sheet_name`: 工作表名称，默认为"Sheet1"
- **输出**:
  - `status`: 转换状态信息
  - `excel_file_path`: 输出Excel文件路径
- **适用场景**: 
  - 将Markdown格式的文档转换为Excel格式
  - 保留Markdown中的表格结构到Excel中
  - 需要自定义Excel工作表名称的场景

### 💾 保存图片节点 (SaveImageNode)
- **位置**: `XnanTool/实用工具`
- **功能**: 将图像保存到指定路径，支持多种格式和质量设置，以及自定义文件名、数值填充位数和工作流保存选项
- **输入**:
  - `images`: 要保存的图像
  - `file_path`: 保存图像的文件夹路径
  - `filename_prefix`: 文件名前缀
  - `folder_separator`: 文件夹分隔符
  - `num_padding_digits`: 文件名数值填充位数（1-9）
  - `extension`: 输出图片格式（PNG/JPEG/WEBP/BMP）
  - `quality`: 图片质量（1-100）
  - `save_workflow`: 保存工作流开关
- **控件**:
  - `filename_prefix`: 文件名前缀
  - `folder_separator`: 文件名与索引之间的分隔符
  - `num_padding_digits`: 文件名中数值的填充位数（1-9）
  - `extension`: 选择输出图片格式
  - `quality`: 图片质量（1-100）
  - `save_workflow`: 是否将工作流信息保存到图片中
- **输出**:
  - `save_result`: 保存操作的结果信息
- **适用场景**: 
  - 需要将ComfyUI生成的图像保存到指定路径
  - 需要自定义输出文件名和格式
  - 需要控制图片质量和文件名格式

### 📊 文本转Excel节点 (TextToExcelNode)
- **位置**: `XnanTool/实用工具`
- **功能**: 将文本内容转换为Excel文件，支持多种分隔符和自定义工作表名称
- **输入**:
  - `text`: 要转换为Excel的文本内容
  - `output_excel_path`: 输出Excel文件名（不含扩展名）
  - `separator`: 分隔符（逗号/分号/制表符/空格/竖线）
  - `sheet_name`: Excel工作表名称
  - `has_header`: 是否包含标题行（可选，默认True）
- **控件**:
  - `text`: 要转换为Excel的文本内容
  - `output_excel_path`: 输出Excel文件名（不含扩展名）
  - `separator`: 选择文本内容的分隔符
  - `sheet_name`: Excel工作表的名称
  - `has_header`: 是否将第一行作为标题行
- **输出**:
  - `save_result`: 保存操作的结果信息
- **适用场景**:
  - 需要将分隔的文本数据转换为Excel表格
  - 需要自定义Excel工作表名称
  - 需要处理不同分隔符的文本数据
  - 需要将文本数据以结构化形式保存

### ⏰ 获取当前时间节点 (GetCurrentTimeNode)
- **位置**: `XnanTool/实用工具`
- **功能**: 获取当前时间戳，输出字符串和整数格式
- **输入**:
  - `format_type`: 时间格式类型（时间戳/日期时间/日期/时间）
- **输出**:
  - `time_string`: 格式化的时间字符串
  - `timestamp_int`: 整数时间戳
- **适用场景**:
  - 需要在工作流中获取当前时间
  - 需要时间戳用于文件命名或标识
  - 需要动态时间信息进行条件判断


## 使用指南

1. 根据需要将实用工具节点添加到您的工作流中。
2. 对于切换值节点，设置好input_value输入以及值A和值B，节点会根据input_value的布尔值输出相应的值。
3. 对于随机执行节点，连接所需的输入端口，并根据需要设置执行模式：
   - random模式：随机选择一个连接的输入进行输出
   - fixed模式：根据position参数选择固定的输入进行输出（position从1开始，超出输入数量时会循环）
   - sequential模式：自动顺序循环选择输入进行输出，执行到底后会重新从头开始执行，不依赖position参数
4. 对于批量复制文件节点，设置好源目录、目标目录和其他选项，节点会执行文件复制操作并返回结果信息。

## 故障排除

如果遇到问题，请检查以下几点：
- 确保输入参数类型正确
- 检查节点之间的连接是否正确
- 确认随机执行节点的模式和参数设置是否符合预期
- 注意sequential顺序循环模式会在执行完所有输入后重新从头开始执行
- 对于批量复制文件节点，确保源目录路径正确且有读取权限，目标目录有写入权限